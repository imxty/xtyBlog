**ACL和RBAC**
============

ACL就是直接给用户添加权限

PRAC就是给用户相应的角色，通过角色来和权限关联
![](../_v_images/_1582724537_1731.png)
****4个模块和常见名称****
=================
![](../_v_images/_1582724550_20653.png)
![](../_v_images/_1582724565_10602.png)
****运行流程****
============
![](../_v_images/_1582724572_30901.png)
****单元测试执行顺序****
================
![](../_v_images/_1582724577_18306.png)
****IniRealm---文本realm****
==========================
![](../_v_images/_1582724584_2433.png)
****JdbcRealm--注意字段名一定要符合规范****
===============================
![](../_v_images/_1582724589_19205.png)
![](../_v_images/_1582724595_30693.png)
****自定义Realm--继承AuthorizingRealm****
====================================
![](../_v_images/_1582724600_17711.png)
****源码流程****
------------
![](../_v_images/_1582724608_10496.png)
认证流程--->subject.login()就是通过一系列调用，最后通过调用AuthenticatingRealm的getAuthenticationInfo方法，调用自定义realm中的doGetAuthenticationInfo方法，

如果返回为null则抛出错误，然后通过和你配置的hashedCredentialsMatcher规则匹配

授权调用--->和认证差不多，也是通过调用查找是否有这个权限的时候，会通过一系列方法最终调用你实现的Author方法。

****过滤器****
===========

****核心过滤器****
-------------
![](../_v_images/_1582724694_1073.png)
****不常用****
-----------
![](../_v_images/_1582724700_24994.png)
****路径配置****
------------
![](../_v_images/_1582724711_13171.png)
****权限控制的3种方式****
=================

****注解权限控制****
--------------
![](../_v_images/_1582724723_6661.png)
****编程方式****
------------
![](../_v_images/_1582724731_17135.png)
****Shiroconfig****
-------------------
![](../_v_images/_1582724744_8249.png)
****缓存模块****
============
![](../_v_images/_1582724753_30324.png)
****ShiroSession****
====================

只要有这个session，就算不登录，也可以登录，因为可以通过这个session创建subject，通过subject来判断所有操作
![](../_v_images/_1582724766_1771.png)
![](../_v_images/_1582724791_17347.png)
****SessionId自定义生成****
----------------------

自定义类
![](../_v_images/_1582724797_2930.png)
添加到配置文件中
![](../_v_images/_1582724802_7919.png)
****RemenberMe****
==================
![](../_v_images/_1582724807_13645.png)
****实战****
==========

****PBAC数据表的实现****
------------------
![](../_v_images/_1582724814_3685.png)
****自定义roles\[admin,user\]****
==============================
![](../_v_images/_1582724823_17008.png)
![](../_v_images/_1582724831_27783.png)
****整合redis缓存****
=================

****service业务方法中加缓存****
-----------------------

****整合redis****
---------------
![](../_v_images/_1582724846_20240.png)
![](../_v_images/_1582724857_10938.png)
设置过期时间
![](../_v_images/_1582724863_23768.png)
![](../_v_images/_1582724893_19036.png)
****Redis整合SessionManager****
-----------------------------
![](../_v_images/_1582724901_15524.png)
这里setGlobalSessionTimeout也对应着redis里面session的过期时间
![](../_v_images/_1582724908_8706.png)
****常用bean配置****
================
![](../_v_images/_1582724916_14134.png)
![](../_v_images/_1582724922_31200.png)